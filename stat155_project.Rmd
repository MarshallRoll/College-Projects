---
title: "Project 1: Data Exploration and Visualization"
author: "Ani Gribbin, Marshall Roll, Deshaun Omane"
date: "9/30/2021"
output: html_document
---
<!--- Begin styling code. --->
<style type="text/css">
/* Whole document: */
body{
  font-family: "Palatino Linotype", "Book Antiqua", Palatino, serif;
  font-size: 12pt;
}
h1.title {
  font-size: 38px;
  text-align: center;
}
h4.author {
  font-size: 18px;
  text-align: center;
}
h4.date {
  font-size: 18px;
  text-align: center;
}
</style>
<!--- End styling code. --->

```{r,echo=FALSE,message=FALSE,warning=FALSE}
library(tidyverse)
library(splitstackshape)
```

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#full_bg <- read_csv("https://raw.githubusercontent.com/bryandmartin/STAT155/master/docs/Projects/project1_bgdataviz/board_game_raw.csv")

#write_csv(full_bg, "./Data/full_bg.csv")

full_bg<-read_csv("./Data/full_bg.csv")
```

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#filter data 
   filtered_bg <- full_bg %>%
   filter(yearpublished >= 1950, users_rated >= 25)
```

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#split category and mechanic variables
filter_mech <-cSplit(filtered_bg,"mechanic")
  #cSplit(filter_mech,"category")
filter_cat<-cSplit(filtered_bg,"category")
  #cSplit(filter_cat,"mechanic")

```
```{r,echo=FALSE,message=FALSE,warning=FALSE}
monopoly <- filter_cat %>%
filter(grepl("Monopoly", name))

#monopoly
```

Monopoly is the fourth most popular board game of all time. Since it was first published in 1933, Monopoly has sold millions of copies across the world and as a result of its popularity, many spin-off games have been made under the same title. In this project, we analyze the 119 Monopoly variants that were published after 1950.

First, we look at the statistics of the original Monopoly game. With over 19,000 ratings, Monopoly has an average rating of 4.4 on a ten-point scale. It is classified as an economic and negotiation game, with an average complexity of approximately 1.7 on a five-point scale. Playing time ranges from 60 to 180 minutes, and anywhere between 2 and 8 people can play the game. Data is collected through the website boardgamegeek.com, which allows any users with an account to add ratings and feedback. 

To begin analysis of the variants, we look at the distribution of their average ratings. 

## 1: Average Rating Compared to Original Monopoly (Boxplot)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
monopoly %>%
  ggplot(aes(y = average_rating)) + 
  geom_boxplot(color = 'darkblue', outlier.colour = "black") +
  geom_point((aes(x = 0, y = 4.4)), color='red') +
  geom_text(label = "Original Monopoly", x = 0.3, y = 4.4, color = "black") +
  scale_x_discrete(labels = NULL, breaks = NULL) +
  labs(title = "Average Rating Distribution of Monopoly Variants", y = "Average Rating", caption = "Average rating increases vertically, with median, interquartile range, outliers, and original Monopoly rating shown in boxplot.") + 
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))

```

The median of the average rating of Monopoly variants is just above five on the ten-point scale. The highest variant score was 6.66, while the lowest was 3.49. When compared to the original Monopoly, most variants have higher ratings. In fact, the original Monopoly would rank in the bottom quartile of the ratings--the middle spread of the data is 0.56, meaning that the middle two quartiles of Monopoly variants fall between the ratings of approximately 4.6 to 5.7. However, due to the varying popularity of the Monopoly variants, some games might have more ratings than others. Also, changing preferences over time may cause older games to be rated more critically by modern players. To test these hypotheses, the relationship between average rating, users rated, and year published must be analyzed. 

# 2. Number of Monopoly Games Published Over Time (Histogram)

```{r,echo=FALSE,message=FALSE,warning=FALSE}
#number of games published per decade histogram
monopoly %>%
ggplot(aes(x=yearpublished)) +
  geom_histogram(binwidth = 1, fill="steelblue")+
  labs(title="Number of Games Published Over Time",x="Year Published", y="Count", caption = "Histogram depicting year published on the x-axis and frequency on the y-axis.")+
  theme_classic()+theme(plot.title = element_text(hjust = 0.5))


```

First, we look at the number of Monopoly variants published by year. The histogram above illustrates the right-skewed bell-curve distribution. More Monopoly variants were published in the last 30 years than in the first 40 years of the game’s existence. This right-skewed distribution shows that the median publishing date was in 2003 with a standard deviation of about 10.7 years. The median value here indicates that half of the Monopoly variants were published before 2003, and half after 2003. Considering the wide range of years published (from 1954 to 2015), we can predict that the popularity of Monopoly variants increased in the early 2000s. Our visualization confirms this, as the highest number of Monopoly variants were published between 2000-2001. We also attribute this popularity to a greater number of Monopoly variants being based on pop culture subjects of interest. The manufacturers perhaps didn’t start to deviate widely from the original Monopoly until the 1990s. Since its publishing peak in 2000,  the number of variants published per year has gradually decreased. 


# 3. Rating of Games by Year Published (Scatterplot)
```{r,echo=FALSE,message=FALSE,warning=FALSE}
monopoly %>%
ggplot(aes(x=yearpublished,y=average_rating))+
  scale_x_continuous(breaks=(seq(1950,2020,10)))+
  scale_y_continuous(breaks=seq(0,10,1))+
  geom_point(color="steelblue")+labs(title="Average Rating Over Time",x ='Year Published', y = 'Average Rating', caption= "Scatterplot depicting year published on the x-axis and average rating, which increases along the y-axis.")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5))


```

Now that we have an understanding of when the Monopoly variants were published, we can examine how their rating varied with time. The scatterplot above depicts a weak positive relationship between year published and average rating for a given Monopoly game. The average rating of a Monopoly variant increases recognizably after 1990. The ratings for all the variants fall between 3.49 and 6.66, which is a relatively small range on the ten-point scale. If we examine this correlation quantitatively, we calculate a correlation coefficient of 0.37. This confirms that, while the relationship is weak, there is some correlation between the year published and the average rating of a variant. 


# 4: Average Rating vs Users Rated vs Years Published (scatterplot)
```{r, echo=FALSE, message=FALSE,warning=FALSE}
monopoly %>%
  ggplot(aes(x = users_rated, y = average_rating, color = yearpublished)) + 
  geom_point(size = 2) +
  scale_x_continuous(trans = "log10") +
  scale_y_continuous(breaks = seq(3,7,1)) + 
  scale_color_continuous(name = "Year Published") +
  labs(title = 'Average Rating vs Users Rated', x ='Users Rated', y = 'Average Rating', caption = "Users rated on x-axis and average rating on y-axis. Color scale represents the year published.") + 
  theme_classic() + 
  theme(plot.title = element_text(hjust = 0.5))

```

We next look to see if average rating is impacted by the number of users rated. Users rated can be used as a proxy to measure popularity--more ratings likely indicate that more people have played the game, regardless of score. There is a weakly positive logarithmic correlation between average rating and users rated. However, the significant number of outliers show that average rating and users rated have little correlation.
Furthermore, the year published, as represented by the shade of each point, seems to have no bearing on number of users rated Thus, despite the increase in varaint production after 2000, the popularity did not necessarily increase in tandem. 

# 5. Playing Time vs Complexity (Scatterplot)
```{r,message=FALSE,echo=FALSE,warning=FALSE}
monopoly <- monopoly %>%   
  mutate(comp_round = round(average_complexity, 0))     #Creates new data set where complexities are whole numbers

monopoly %>%
  ggplot(aes(x = factor(comp_round), y = playingtime)) +
  geom_boxplot(color='steelblue') +
  geom_point((aes(x = 3, y = 180)), color='red') +
  geom_text(label = "Original Monopoly", x = 2.65, y = 198.5, color = "black") +
  labs(title="Average Playing Time of Different Complexities",x="Level of Complexity",y="Average Playing Time", caption = "Average complexity on the x-axis and average playing time on the y-axis. Original Monopoly shown.")+
  theme_bw()+          #Removes grey
  theme(plot.title = element_text(hjust = 0.5))  #Centers the title

```

Monopoly is widely notorious for being a game that requires a large investment of time as many people often find themselves locked into hours of intense gameplay with no end. From this observation, we hypothesized that the games that take the longest may have higher levels of complexity. Complexity was  rated by online users, and then rounded to the nearest whole number. The box plot above shows that Monopoly games with a level of complexity above two, generally take longer than 95 minutes, although there is one outlier of 300 minutes. When compared with the original Monopoly, most of the variants are simpler and take less time. The most interesting conclusion we can garner from the box plot is that there is no real relationship between the complexity level of the game and average playing time. One potential explanation for the lack of relationship is having to keep track of the cash flow when buying properties or paying rent. Another reason might be that from our collective experiences people often find themselves in some sort of argument while playing the game. Regardless, the lack of a clear relationship between increasing complexity and playing time facilitates the simplistic nature of the game.

# 6. Category vs Complexity (Histogram)
```{r,echo=FALSE,message=FALSE,warning=FALSE}
monopoly %>%
  ggplot(aes(x=average_complexity)) +
  geom_histogram(binwidth=1, fill="steelblue")+
  facet_wrap(.~category_01,nrow=2)+      #Divides the data into two rows
  labs(title="Game Complexity Compared by Category", x="Level of Complexity", caption = "Side-by-side histograms by category; average complexity on the x-axis and frequency on the y-axis.")+
  theme_bw()+
  theme(strip.text.x = element_text(size=10))+          #Centers font size of the category headings
  theme(plot.title = element_text(hjust = 0.5))         #Centers the title
```

The different versions of Monopoly can be categorized into various subset genres that offer unique gaming experiences. The histogram above displays the complexity of all the games that fall within each category. Based on the frequency of games shown, it is clear that a majority of the variants fall under the economic categorization-- Monopoly typically relies on the flow of currency being a core function within games. Another observation we can gather from the histograms is that all Monopoly games have relatively low levels of complexity, never exceeding 3.4 on the complexity scale. Moreover, the histogram shows that most Monopoly games are rated approximately two in complexity. The only category where some Monopoly games are considered to be threes on the complexity scale is economic. Overall, however, Monopoly variants do not seem to be extremely difficult. 


After the uptick in production after 2000, popularity and ratings of Monopoly variants did not necessarily increase. Some variants out-performed the original Monopoly in average rating, but others fell short. We hypothesize that the lack of any strong relationship between the variants highlights the differences between the games in terms of category, mechanic, and target audience. Furthermore, none of the variants managed to gain as many ratings as the original Monopoly, and are therefore likely less popular. Despite continued publication, variants may simply never be able to replicate the iconic nature of the original Monopoly. 


# Code Appendix
```{r,eval=FALSE}
library(tidyverse)
library(splitstackshape)

full_bg <- read.csv("https://raw.githubusercontent.com/bryandmartin/STAT155/master/docs/Projects/project1_bgdataviz/board_game_raw.csv")

write_csv(full_bg, "./Data/full_bg.csv")

full_bg<-read_csv("./Data/full_bg.csv")

 filtered_bg <- full_bg %>%
   filter(yearpublished >= 1950, users_rated >= 25)

ilter_mech <-cSplit(filtered_bg,"mechanic")
  cSplit(filter_mech,"category")
filter_cat<-cSplit(filtered_bg,"category")
  cSplit(filter_cat,"mechanic")

monopoly <-filter_cat %>%
filter(grepl("Monopoly", name))
monopoly

#original monopoly data
head(full_bg[1211, 3:15])

#visualization 1
monopoly %>%
  ggplot(aes(y = average_rating)) + 
  geom_boxplot(color = 'darkblue', outlier.colour = "black") +
  geom_point((aes(x = 0, y = 4.4)), color='red') +
  geom_text(label = "Original Monopoly", x = 0.3, y = 4.4, color = "black") +
  scale_x_discrete(labels = NULL, breaks = NULL) +
  labs(title = "Average Rating Distribution of Monopoly Variants", y = "Average Rating", caption = "Average rating increases vertically, with median, interquartile range, outliers, and original Monopoly rating shown in boxplot.") + 
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))

monopoly %>%
  summarize(median(average_rating), max(average_rating), min(average_rating), mean(average_rating), IQR(average_rating))

#visualization2
#number of games published per decade histogram
monopoly %>%
ggplot(aes(x=yearpublished)) +
  geom_histogram(binwidth = 1, fill="steelblue")+
  labs(title="Number of Games Published Over Time",x="Year Published", y="Count", caption = "Histogram depicting year published on the x-axis and frequency on the y-axis.")+
  theme_classic()+theme(plot.title = element_text(hjust = 0.5))


monopoly %>%
  summarize(median(average_rating), range1 = max(average_rating) - min(average_rating), range2 = max(users_rated) - min(users_rated))

#visualization3
monopoly %>%
ggplot(aes(x=yearpublished,y=average_rating))+
  scale_x_continuous(breaks=(seq(1950,2020,10)))+
  scale_y_continuous(breaks=seq(0,10,1))+
  geom_point(color="steelblue")+labs(title="Average Rating Over Time",x ='Year Published', y = 'Average Rating', caption= "Scatterplot depicting year published on the x-axis and average rating, which increases along the y-axis.")+
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5))


monopoly %>%
  summarize(
    mean(yearpublished), 
    median(yearpublished), 
  )

#visualization4
monopoly %>%
  ggplot(aes(x = users_rated, y = average_rating, color = yearpublished)) + 
  geom_point(size = 2) +
  scale_x_continuous(trans = "log10") +
  scale_y_continuous(breaks = seq(3,7,1)) + 
  scale_color_continuous(name = "Year Published") +
  labs(title = 'Average Rating vs Users Rated', x ='Users Rated', y = 'Average Rating', caption = "Scatterplot showing number of users rated, which increases along the x-axis, and average rating which increases along the y-axis. Color scale represents the year published, with darker blue indicating older publishing dates.") + 
  theme_classic() + 
  theme(plot.title = element_text(hjust = 0.5))


monopoly <- monopoly %>%   
  mutate(comp_round = round(average_complexity, 0))     #Creates new data set where complexities are whole numbers

monopoly %>%
  ggplot(aes(x = factor(comp_round), y = playingtime)) +
  geom_boxplot(color='steelblue') +
  geom_point((aes(x = 3, y = 180)), color='red') +
  geom_text(label = "Original Monopoly", x = 2.65, y = 198.5, color = "black") +
  labs(title="Average Playing Time of Different Complexities",x="Level of Complexity",y="Average Playing Time", caption = "Side-by side boxplots showing average complexity, rounded to the nearest whole number on the x-axis and average playing time, which increases vertically along the y-axis. Original Monopoly shown as point of comparison.")+
  theme_bw()+          #Removes grey
  theme(plot.title = element_text(hjust = 0.5))  #Centers the title

monopoly %>%
  select(playingtime) %>%
  summary()   #Gives numerical summaries like the mean median and IQR

#visualization6
monopoly %>%
  ggplot(aes(x=average_complexity)) +
  geom_histogram(binwidth=1, fill="steelblue")+
  facet_wrap(.~category_01,nrow=2)+      #Divides the data into two rows
  labs(title="Game Complexity Compared by Category", x="Level of Complexity", caption = "Side-by-side histograms broken down by category; average complexity rounded to the nearest whole number along the x-axis and frequency increasing along the y-axis.")+
  theme_bw()+
  theme(strip.text.x = element_text(size=10))+          #Centers font size of the category headings
  theme(plot.title = element_text(hjust = 0.5))         #Centers the title

```